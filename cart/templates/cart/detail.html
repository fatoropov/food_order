{% extends "food_order/base.html" %}
{% load static %}

{% block page_header %}
  <h1 class="display-3">Корзина <span class="badge badge-secondary badge-pill">{{ cart.len }}</span></h1>
{% endblock %}

{% block content %}
{% if cart %}
<div class="container">
  <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 g-3">

    {% for item in cart %}
      {% with dish=item.dish %}
        <div class="col-md-6 col-sm-12 col-md-offset-1">
          <div class="card mb-3">
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6 col-sm-5">
                    <a href="{{ dish.get_absolute_url }}">
                        <img class="card-img-top w-30 h-40"
                            src="{% if dish.image %}{{ dish.image.url }}
                                  {% else %}{% static 'img/no_image.png' %}{% endif %}"
                            alt="">
                    </a>
                  </div>
                  <div class="col-md-4 col-sm-7">
                    <a href="{{ dish.get_absolute_url }}"><h5
                            class="card-title">{{ dish.name }}</h5></a>

                    <p class="card-text">{{ dish.description|slice:"0:30" }}...</p>
                  </div>
                </div>
              </div>
              <ul class="list-group list-group-flush">
                  <li class="list-group-item bg-light">
                      <div class="row text-center">
                          <div class="col-sm-6 col-md-6">
                              <a href="{% url 'cart:cart_update_plus' dish.id %}"
                                class="btn btn-outline-dark btn-sm">&plus;</a>
                              {{ item.quantity }}
                              <a href="{% url 'cart:cart_update_minus' dish.id %}"
                                class="btn btn-outline-dark btn-sm">&minus;</a>
                          </div>
                          <div class="col-sm-6 col-md-6">Цена за штуку: {{ item.price }} руб.</div>
                          <div class="col-lg-4">

                          </div>
                      </div>
                  </li>
              </ul>
          </div>
        </div>
      {% endwith %}
    {% endfor %}
  </div>
  <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2" >
    <div class="col-sm-4 col-md-8"></div>
    <div class="col-sm-4 col-md-2">
      <h4  class="float-right">Итого:</h4 >
    </div>
    <div class="col-sm-4 col-md-2">
      <h4 class="float-right">{{ cart.get_total_price}} руб.</h4>
    </div>

  </div>
  <div class="row">
    <div class="col-sm-3 col-md-7"></div>
    <div class="col-sm-4 col-md-2">
      <a class="btn btn-danger btn-lg float-right" href="{% url 'cart:cart_clear' %}">
        Очистить корзину
      </a>
    </div>
    <div class="col-sm-1 col-md-1"></div>
    <div class="col-sm-4 col-md-2">
      <a class="btn btn-success btn-lg float-right" href="{% url 'orders:order_create' %}">
          Перейти к заказу
      </a>
    </div>
  </div>
</div>
{% else %}
  <h4 class="mt-3 mb-3 text-center">
      Корзина пуста
  </h4>
{% endif %}


<!--
<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center"></h5>
    </div>
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center">Блюдо</h5>
    </div>
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center">Количество</h5>
    </div>
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center">Стоимость</h5>
    </div>
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center">Сумма</h5>
    </div>
    <div class="col-md-2 col-sm-2 col-md-offset-1">
      <h5 class="text-center"></h5>
    </div>


    <table class="table table-striped table-responsive-sm shoplist">
        <thead class="shopunit" data-sizes="[&quot;4&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;]">
          <tr>
            <th class="primary">
              
            </th>
            <th class="primary">
              
            </th>
            <th class="primary">
              
            </th>
            <th class="primary">
              
            </th>
            <th class="primary">
              
            </th>
            <th class="primary">
              
            </th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart %}
            {% with dish=item.dish %}
              <tr>
                <td>
                  <div class="card-img-top">
                    <a href="{{ dish.get_absolute_url }}">
                      <img src="{% if dish.image %}{{ dish.image.url }}
                      {% else %}{% static 'img/no_image.png' %}{% endif %}" width="225" height="150" >    
                    </a>
                  </div>
                </td>
                <td>
                  <h5 class="text-center">{{ dish.name }}</h5>
                </td>
                <td>
                  <h5 class="text-center">{{ item.quantity }}</h5>
                </td>
                <td>
                  <h5 class="text-center">{{ dish.price }} ₽</h5>
                </td>
                <td>
                  <h5 class="text-center">{{ item.total_price }} ₽</h5>
                </td>
                <td>
                  <form action="{% url 'cart:cart_remove' dish.id %}" method="post">
                    <button role="submit" class="btn btn-outline-danger">Удалить</button>
                    <input type="hidden">
                    {% csrf_token %}
                  </form>
                </td>
              </tr>
            {% endwith %}
          {% endfor %}
          <tr class="text-right">
            <td colspan="4"></td>
            <td><h3>Итого:</h3></td>
            <td class="num">{{ cart.get_total_price }} ₽</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
  <div class="row">
    <div class="col-md-7 col-sm-7">
    </div>
    <div class="col-md-2 col-sm-5">
        <a href="{% url 'food_order:dish_list' %}" class="btn btn-outline-primary">Продолжить покупки</a>
        <a href="{% url 'orders:order_create' %}" class="btn btn-primary">Перейти к заказу</a>
    </div>
  </div>
</div>
-->
{% endblock %}